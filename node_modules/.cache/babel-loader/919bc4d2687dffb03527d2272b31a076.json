{"ast":null,"code":"var _jsxFileName = \"/Users/hyera/Documents/localhost/react-firebase/React-firebase-test/src/pages/shop/crud.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useState, useEffect } from 'react';\nimport firebase from '../../service/firebase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Crud() {\n  _s();\n\n  //goods state\n  const [goods, setGoods] = useState([]); //firebase DB\n\n  const dbRef = firebase.database().ref('/goods'); //read\n\n  useEffect(() => {\n    dbRef.on('value', snapshot => {\n      const datas = snapshot.val();\n      const goodsData = [];\n\n      for (let id in datas) {\n        goodsData.push({ ...datas[id],\n          id\n        });\n      }\n\n      setGoods(goodsData);\n    });\n  }, []);\n  console.log(goods); //id 상태값\n\n  const nextId = useRef(goods.length); //input  state\n\n  const [inputs, setInputs] = useState({\n    sGoodsName: '',\n    iSellPrice: ''\n  }); //input값 넘기기\n\n  const onChange = e => {\n    ///불변성 을 지키키위함.\n    setInputs({ ...inputs,\n      [e.target.name]: e.target.value\n    });\n  }; // 상품추가\n\n\n  const onCreate = () => {\n    const obj = {\n      id: nextId.current,\n      sGoodsName: inputs.sGoodsName,\n      iSellPrice: Number(inputs.iSellPrice),\n      likeCount: 0,\n      sSellStatus: true,\n      iaccumulate: 0\n    }; // setGoods([...goods, obj]); // 방법1\n\n    setGoods(goods.concat(obj)); // 방법2\n\n    dbRef.push().set(obj).then(() => console.log('Data updated.'));\n    setInputs({\n      sGoodsName: '',\n      iSellPrice: ''\n    });\n    nextId.current += 1;\n  }; //상품 업데이트\n  //input  state\n\n\n  const [editInputs, editSetInputs] = useState({\n    id: '',\n    sGoodsName: '',\n    iSellPrice: ''\n  }); //상품 토글\n\n  const onToggle = (e, id) => {\n    e.target.classList.toggle('active');\n  }; //상품 좋아요\n\n\n  const onLike = id => {\n    setGoods(goods.map(item => item.id === id ? { ...item,\n      likeCount: item.likeCount += 1\n    } : item));\n  }; //상품 수정\n\n\n  const onEdit = id => {\n    //fncSandId(id);\n    const thisId = id;\n    firebase.database().ref(`/goods/${id}`).on('value', snapshot => {\n      const data = snapshot.val();\n      console.log('data', data);\n      editSetInputs({ ...editInputs,\n        id: thisId,\n        sGoodsName: data.sGoodsName,\n        iSellPrice: data.iSellPrice\n      });\n    });\n  }; //input값 넘기기\n\n\n  const onEditChange = e => {\n    editSetInputs({ ...editInputs,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const onEditSucess = id => {\n    firebase.database().ref(`/goods/${id}`).update(editInputs);\n  }; //상품 삭제\n\n\n  const onDelect = id => {\n    // item.id !== id 제외한 값만 새로운 배열을 만듬\n    // = item.id 가 id 인 것을 제거함\n    console.log(id);\n    const resultArray = goods.filter(item => item.id !== id);\n    console.log(resultArray);\n    setGoods(resultArray); //데이터 처리하는 로직\n\n    firebase.database().ref(`/goods/${id}`).remove();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-5\",\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"React Firebase Database CRUD\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-4 \",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"f3 mb-4\",\n          children: \"\\uC785\\uB825\\uD3FC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"sGoodsName\",\n            value: inputs.sGoodsName,\n            placeholder: \"\\uC0C1\\uD488\\uBA85\",\n            onChange: onChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"iSellPrice\",\n            value: inputs.iSellPrice,\n            placeholder: \"\\uD310\\uB9E4\\uAC00\\uACA9\",\n            onChange: onChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onCreate,\n          className: \"button mt-4\",\n          children: \"\\uB4F1\\uB85D\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"f3 mb-4\",\n          children: \"\\uC0C1\\uD488\\uB9AC\\uC2A4\\uD2B8\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"goods_list\",\n          children: goods.map(item => /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"title mr-2 text-primary\",\n              onClick: e => onToggle(e, item.id),\n              children: item.sGoodsName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"mr-4\",\n              children: [\"\\uAC00\\uACA9: \", item.iSellPrice]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => onLike(item.id),\n              children: [\"\\u2764 \", item.likeCount]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => onEdit(item.id),\n              className: \"button sm ml-4\",\n              children: \"\\uC218\\uC815\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => onDelect(item.id),\n              className: \"button sm ml-1\",\n              children: \"\\uC0AD\\uC81C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 9\n            }, this)]\n          }, item.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 8\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"f3 mb-2\",\n            children: \"\\uC218\\uC815\\uD3FC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"sGoodsName\",\n              value: editInputs.sGoodsName,\n              placeholder: \"\\uC0C1\\uD488\\uBA85\",\n              onChange: onEditChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 8\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"iSellPrice\",\n              value: editInputs.iSellPrice,\n              placeholder: \"\\uD310\\uB9E4\\uAC00\\uACA9\",\n              onChange: onEditChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 8\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => onEditSucess(editInputs.id),\n            className: \"button mt-4\",\n            children: \"\\uC218\\uC815\\uC644\\uB8CC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Crud, \"0skR2hv5G0EhfuZaPeAmlOXg1OY=\");\n\n_c = Crud;\nexport default Crud;\n\nvar _c;\n\n$RefreshReg$(_c, \"Crud\");","map":{"version":3,"sources":["/Users/hyera/Documents/localhost/react-firebase/React-firebase-test/src/pages/shop/crud.js"],"names":["React","useRef","useState","useEffect","firebase","Crud","goods","setGoods","dbRef","database","ref","on","snapshot","datas","val","goodsData","id","push","console","log","nextId","length","inputs","setInputs","sGoodsName","iSellPrice","onChange","e","target","name","value","onCreate","obj","current","Number","likeCount","sSellStatus","iaccumulate","concat","set","then","editInputs","editSetInputs","onToggle","classList","toggle","onLike","map","item","onEdit","thisId","data","onEditChange","onEditSucess","update","onDelect","resultArray","filter","remove"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,MAAhB,EAAwBC,QAAxB,EAAkCC,SAAlC,QAAmD,OAAnD;AAEA,OAAOC,QAAP,MAAqB,wBAArB;;;;AAEA,SAASC,IAAT,GAAgB;AAAA;;AACf;AACA,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBL,QAAQ,CAAC,EAAD,CAAlC,CAFe,CAIf;;AACA,QAAMM,KAAK,GAAGJ,QAAQ,CAACK,QAAT,GAAoBC,GAApB,CAAwB,QAAxB,CAAd,CALe,CAOf;;AACAP,EAAAA,SAAS,CAAC,MAAM;AACfK,IAAAA,KAAK,CAACG,EAAN,CAAS,OAAT,EAAmBC,QAAD,IAAc;AAC/B,YAAMC,KAAK,GAAGD,QAAQ,CAACE,GAAT,EAAd;AACA,YAAMC,SAAS,GAAG,EAAlB;;AACA,WAAK,IAAIC,EAAT,IAAeH,KAAf,EAAsB;AACrBE,QAAAA,SAAS,CAACE,IAAV,CAAe,EAAE,GAAGJ,KAAK,CAACG,EAAD,CAAV;AAAgBA,UAAAA;AAAhB,SAAf;AACA;;AAEDT,MAAAA,QAAQ,CAACQ,SAAD,CAAR;AACA,KARD;AASA,GAVQ,EAUN,EAVM,CAAT;AAYAG,EAAAA,OAAO,CAACC,GAAR,CAAYb,KAAZ,EApBe,CAsBf;;AACA,QAAMc,MAAM,GAAGnB,MAAM,CAACK,KAAK,CAACe,MAAP,CAArB,CAvBe,CAyBf;;AACA,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBrB,QAAQ,CAAC;AACpCsB,IAAAA,UAAU,EAAE,EADwB;AAEpCC,IAAAA,UAAU,EAAE;AAFwB,GAAD,CAApC,CA1Be,CA+Bf;;AACA,QAAMC,QAAQ,GAAIC,CAAD,IAAO;AACvB;AACAJ,IAAAA,SAAS,CAAC,EACT,GAAGD,MADM;AAET,OAACK,CAAC,CAACC,MAAF,CAASC,IAAV,GAAiBF,CAAC,CAACC,MAAF,CAASE;AAFjB,KAAD,CAAT;AAIA,GAND,CAhCe,CAwCf;;;AACA,QAAMC,QAAQ,GAAG,MAAM;AACtB,UAAMC,GAAG,GAAG;AACXhB,MAAAA,EAAE,EAAEI,MAAM,CAACa,OADA;AAEXT,MAAAA,UAAU,EAAEF,MAAM,CAACE,UAFR;AAGXC,MAAAA,UAAU,EAAES,MAAM,CAACZ,MAAM,CAACG,UAAR,CAHP;AAIXU,MAAAA,SAAS,EAAE,CAJA;AAKXC,MAAAA,WAAW,EAAE,IALF;AAMXC,MAAAA,WAAW,EAAE;AANF,KAAZ,CADsB,CAStB;;AAEA9B,IAAAA,QAAQ,CAACD,KAAK,CAACgC,MAAN,CAAaN,GAAb,CAAD,CAAR,CAXsB,CAWO;;AAE7BxB,IAAAA,KAAK,CACHS,IADF,GAEEsB,GAFF,CAEMP,GAFN,EAGEQ,IAHF,CAGO,MAAMtB,OAAO,CAACC,GAAR,CAAY,eAAZ,CAHb;AAKAI,IAAAA,SAAS,CAAC;AACTC,MAAAA,UAAU,EAAE,EADH;AAETC,MAAAA,UAAU,EAAE;AAFH,KAAD,CAAT;AAIAL,IAAAA,MAAM,CAACa,OAAP,IAAkB,CAAlB;AACA,GAvBD,CAzCe,CAkEf;AAEA;;;AACA,QAAM,CAACQ,UAAD,EAAaC,aAAb,IAA8BxC,QAAQ,CAAC;AAC5Cc,IAAAA,EAAE,EAAE,EADwC;AAE5CQ,IAAAA,UAAU,EAAE,EAFgC;AAG5CC,IAAAA,UAAU,EAAE;AAHgC,GAAD,CAA5C,CArEe,CA2Ef;;AACA,QAAMkB,QAAQ,GAAG,CAAChB,CAAD,EAAIX,EAAJ,KAAW;AAC3BW,IAAAA,CAAC,CAACC,MAAF,CAASgB,SAAT,CAAmBC,MAAnB,CAA0B,QAA1B;AACA,GAFD,CA5Ee,CAgFf;;;AACA,QAAMC,MAAM,GAAI9B,EAAD,IAAQ;AACtBT,IAAAA,QAAQ,CACPD,KAAK,CAACyC,GAAN,CAAWC,IAAD,IACTA,IAAI,CAAChC,EAAL,KAAYA,EAAZ,GAAiB,EAAE,GAAGgC,IAAL;AAAWb,MAAAA,SAAS,EAAGa,IAAI,CAACb,SAAL,IAAkB;AAAzC,KAAjB,GAAiEa,IADlE,CADO,CAAR;AAKA,GAND,CAjFe,CAyFf;;;AACA,QAAMC,MAAM,GAAIjC,EAAD,IAAQ;AACtB;AAEA,UAAMkC,MAAM,GAAGlC,EAAf;AACAZ,IAAAA,QAAQ,CACNK,QADF,GAEEC,GAFF,CAEO,UAASM,EAAG,EAFnB,EAGEL,EAHF,CAGK,OAHL,EAGeC,QAAD,IAAc;AAC1B,YAAMuC,IAAI,GAAGvC,QAAQ,CAACE,GAAT,EAAb;AACAI,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBgC,IAApB;AAEAT,MAAAA,aAAa,CAAC,EACb,GAAGD,UADU;AAEbzB,QAAAA,EAAE,EAAEkC,MAFS;AAGb1B,QAAAA,UAAU,EAAE2B,IAAI,CAAC3B,UAHJ;AAIbC,QAAAA,UAAU,EAAE0B,IAAI,CAAC1B;AAJJ,OAAD,CAAb;AAMA,KAbF;AAcA,GAlBD,CA1Fe,CA8Gf;;;AACA,QAAM2B,YAAY,GAAIzB,CAAD,IAAO;AAC3Be,IAAAA,aAAa,CAAC,EACb,GAAGD,UADU;AAEb,OAACd,CAAC,CAACC,MAAF,CAASC,IAAV,GAAiBF,CAAC,CAACC,MAAF,CAASE;AAFb,KAAD,CAAb;AAIA,GALD;;AAOA,QAAMuB,YAAY,GAAIrC,EAAD,IAAQ;AAC5BZ,IAAAA,QAAQ,CAACK,QAAT,GAAoBC,GAApB,CAAyB,UAASM,EAAG,EAArC,EAAwCsC,MAAxC,CAA+Cb,UAA/C;AACA,GAFD,CAtHe,CA0Hf;;;AACA,QAAMc,QAAQ,GAAIvC,EAAD,IAAQ;AACxB;AACA;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAYH,EAAZ;AACA,UAAMwC,WAAW,GAAGlD,KAAK,CAACmD,MAAN,CAAcT,IAAD,IAAUA,IAAI,CAAChC,EAAL,KAAYA,EAAnC,CAApB;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAYqC,WAAZ;AACAjD,IAAAA,QAAQ,CAACiD,WAAD,CAAR,CANwB,CAOxB;;AACApD,IAAAA,QAAQ,CAACK,QAAT,GAAoBC,GAApB,CAAyB,UAASM,EAAG,EAArC,EAAwC0C,MAAxC;AACA,GATD;;AAWA,sBACC;AAAA,4BACC;AAAK,MAAA,SAAS,EAAC,kBAAf;AAAA,6BACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADD;AAAA;AAAA;AAAA;AAAA,YADD,eAIC;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA,8BACC;AAAK,QAAA,SAAS,EAAC,QAAf;AAAA,gCACC;AAAI,UAAA,SAAS,EAAC,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADD,eAEC;AAAA,iCACC;AACC,YAAA,IAAI,EAAC,YADN;AAEC,YAAA,KAAK,EAAEpC,MAAM,CAACE,UAFf;AAGC,YAAA,WAAW,EAAC,oBAHb;AAIC,YAAA,QAAQ,EAAEE;AAJX;AAAA;AAAA;AAAA;AAAA;AADD;AAAA;AAAA;AAAA;AAAA,gBAFD,eAUC;AAAA,iCACC;AACC,YAAA,IAAI,EAAC,YADN;AAEC,YAAA,KAAK,EAAEJ,MAAM,CAACG,UAFf;AAGC,YAAA,WAAW,EAAC,0BAHb;AAIC,YAAA,QAAQ,EAAEC;AAJX;AAAA;AAAA;AAAA;AAAA;AADD;AAAA;AAAA;AAAA;AAAA,gBAVD,eAkBC;AAAQ,UAAA,OAAO,EAAEK,QAAjB;AAA2B,UAAA,SAAS,EAAC,aAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAlBD;AAAA;AAAA;AAAA;AAAA;AAAA,cADD,eAwBC;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA,gCACC;AAAI,UAAA,SAAS,EAAC,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADD,eAGC;AAAI,UAAA,SAAS,EAAC,YAAd;AAAA,oBACEzB,KAAK,CAACyC,GAAN,CAAWC,IAAD,iBACV;AAAA,oCAGC;AACC,cAAA,SAAS,EAAC,yBADX;AAEC,cAAA,OAAO,EAAGrB,CAAD,IAAOgB,QAAQ,CAAChB,CAAD,EAAIqB,IAAI,CAAChC,EAAT,CAFzB;AAAA,wBAIEgC,IAAI,CAACxB;AAJP;AAAA;AAAA;AAAA;AAAA,oBAHD,eASC;AAAM,cAAA,SAAS,EAAC,MAAhB;AAAA,2CAA4BwB,IAAI,CAACvB,UAAjC;AAAA;AAAA;AAAA;AAAA;AAAA,oBATD,eAUC;AAAQ,cAAA,OAAO,EAAE,MAAMqB,MAAM,CAACE,IAAI,CAAChC,EAAN,CAA7B;AAAA,oCACIgC,IAAI,CAACb,SADT;AAAA;AAAA;AAAA;AAAA;AAAA,oBAVD,eAcC;AACC,cAAA,OAAO,EAAE,MAAMc,MAAM,CAACD,IAAI,CAAChC,EAAN,CADtB;AAEC,cAAA,SAAS,EAAC,gBAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAdD,eAqBC;AACC,cAAA,OAAO,EAAE,MAAMuC,QAAQ,CAACP,IAAI,CAAChC,EAAN,CADxB;AAEC,cAAA,SAAS,EAAC,gBAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBArBD;AAAA,aAASgC,IAAI,CAAChC,EAAd;AAAA;AAAA;AAAA;AAAA,kBADA;AADF;AAAA;AAAA;AAAA;AAAA,gBAHD,eAsCC;AAAK,UAAA,SAAS,EAAC,MAAf;AAAA,kCACC;AAAI,YAAA,SAAS,EAAC,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADD,eAEC;AAAA,mCACC;AACC,cAAA,IAAI,EAAC,YADN;AAEC,cAAA,KAAK,EAAEyB,UAAU,CAACjB,UAFnB;AAGC,cAAA,WAAW,EAAC,oBAHb;AAIC,cAAA,QAAQ,EAAE4B;AAJX;AAAA;AAAA;AAAA;AAAA;AADD;AAAA;AAAA;AAAA;AAAA,kBAFD,eAUC;AAAA,mCACC;AACC,cAAA,IAAI,EAAC,YADN;AAEC,cAAA,KAAK,EAAEX,UAAU,CAAChB,UAFnB;AAGC,cAAA,WAAW,EAAC,0BAHb;AAIC,cAAA,QAAQ,EAAE2B;AAJX;AAAA;AAAA;AAAA;AAAA;AADD;AAAA;AAAA;AAAA;AAAA,kBAVD,eAkBC;AACC,YAAA,OAAO,EAAE,MAAMC,YAAY,CAACZ,UAAU,CAACzB,EAAZ,CAD5B;AAEC,YAAA,SAAS,EAAC,aAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAlBD;AAAA;AAAA;AAAA;AAAA;AAAA,gBAtCD;AAAA;AAAA;AAAA;AAAA;AAAA,cAxBD;AAAA;AAAA;AAAA;AAAA;AAAA,YAJD;AAAA,kBADD;AAgGA;;GAtOQX,I;;KAAAA,I;AAwOT,eAAeA,IAAf","sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\n\nimport firebase from '../../service/firebase';\n\nfunction Crud() {\n\t//goods state\n\tconst [goods, setGoods] = useState([]);\n\n\t//firebase DB\n\tconst dbRef = firebase.database().ref('/goods');\n\n\t//read\n\tuseEffect(() => {\n\t\tdbRef.on('value', (snapshot) => {\n\t\t\tconst datas = snapshot.val();\n\t\t\tconst goodsData = [];\n\t\t\tfor (let id in datas) {\n\t\t\t\tgoodsData.push({ ...datas[id], id });\n\t\t\t}\n\n\t\t\tsetGoods(goodsData);\n\t\t});\n\t}, []);\n\n\tconsole.log(goods);\n\n\t//id 상태값\n\tconst nextId = useRef(goods.length);\n\n\t//input  state\n\tconst [inputs, setInputs] = useState({\n\t\tsGoodsName: '',\n\t\tiSellPrice: '',\n\t});\n\n\t//input값 넘기기\n\tconst onChange = (e) => {\n\t\t///불변성 을 지키키위함.\n\t\tsetInputs({\n\t\t\t...inputs,\n\t\t\t[e.target.name]: e.target.value,\n\t\t});\n\t};\n\n\t// 상품추가\n\tconst onCreate = () => {\n\t\tconst obj = {\n\t\t\tid: nextId.current,\n\t\t\tsGoodsName: inputs.sGoodsName,\n\t\t\tiSellPrice: Number(inputs.iSellPrice),\n\t\t\tlikeCount: 0,\n\t\t\tsSellStatus: true,\n\t\t\tiaccumulate: 0,\n\t\t};\n\t\t// setGoods([...goods, obj]); // 방법1\n\n\t\tsetGoods(goods.concat(obj)); // 방법2\n\n\t\tdbRef\n\t\t\t.push()\n\t\t\t.set(obj)\n\t\t\t.then(() => console.log('Data updated.'));\n\n\t\tsetInputs({\n\t\t\tsGoodsName: '',\n\t\t\tiSellPrice: '',\n\t\t});\n\t\tnextId.current += 1;\n\t};\n\n\t//상품 업데이트\n\n\t//input  state\n\tconst [editInputs, editSetInputs] = useState({\n\t\tid: '',\n\t\tsGoodsName: '',\n\t\tiSellPrice: '',\n\t});\n\n\t//상품 토글\n\tconst onToggle = (e, id) => {\n\t\te.target.classList.toggle('active');\n\t};\n\n\t//상품 좋아요\n\tconst onLike = (id) => {\n\t\tsetGoods(\n\t\t\tgoods.map((item) =>\n\t\t\t\titem.id === id ? { ...item, likeCount: (item.likeCount += 1) } : item\n\t\t\t)\n\t\t);\n\t};\n\n\t//상품 수정\n\tconst onEdit = (id) => {\n\t\t//fncSandId(id);\n\n\t\tconst thisId = id;\n\t\tfirebase\n\t\t\t.database()\n\t\t\t.ref(`/goods/${id}`)\n\t\t\t.on('value', (snapshot) => {\n\t\t\t\tconst data = snapshot.val();\n\t\t\t\tconsole.log('data', data);\n\n\t\t\t\teditSetInputs({\n\t\t\t\t\t...editInputs,\n\t\t\t\t\tid: thisId,\n\t\t\t\t\tsGoodsName: data.sGoodsName,\n\t\t\t\t\tiSellPrice: data.iSellPrice,\n\t\t\t\t});\n\t\t\t});\n\t};\n\n\t//input값 넘기기\n\tconst onEditChange = (e) => {\n\t\teditSetInputs({\n\t\t\t...editInputs,\n\t\t\t[e.target.name]: e.target.value,\n\t\t});\n\t};\n\n\tconst onEditSucess = (id) => {\n\t\tfirebase.database().ref(`/goods/${id}`).update(editInputs);\n\t};\n\n\t//상품 삭제\n\tconst onDelect = (id) => {\n\t\t// item.id !== id 제외한 값만 새로운 배열을 만듬\n\t\t// = item.id 가 id 인 것을 제거함\n\t\tconsole.log(id);\n\t\tconst resultArray = goods.filter((item) => item.id !== id);\n\t\tconsole.log(resultArray);\n\t\tsetGoods(resultArray);\n\t\t//데이터 처리하는 로직\n\t\tfirebase.database().ref(`/goods/${id}`).remove();\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<div className=\"text-center py-5\">\n\t\t\t\t<h2>React Firebase Database CRUD</h2>\n\t\t\t</div>\n\t\t\t<div className=\"row container\">\n\t\t\t\t<div className=\"col-4 \">\n\t\t\t\t\t<h4 className=\"f3 mb-4\">입력폼</h4>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tname=\"sGoodsName\"\n\t\t\t\t\t\t\tvalue={inputs.sGoodsName}\n\t\t\t\t\t\t\tplaceholder=\"상품명\"\n\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tname=\"iSellPrice\"\n\t\t\t\t\t\t\tvalue={inputs.iSellPrice}\n\t\t\t\t\t\t\tplaceholder=\"판매가격\"\n\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button onClick={onCreate} className=\"button mt-4\">\n\t\t\t\t\t\t등록\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"col-8\">\n\t\t\t\t\t<h4 className=\"f3 mb-4\">상품리스트</h4>\n\n\t\t\t\t\t<ul className=\"goods_list\">\n\t\t\t\t\t\t{goods.map((item) => (\n\t\t\t\t\t\t\t<li key={item.id}>\n\t\t\t\t\t\t\t\t{/*<span className=\"mr-2\">[{item.id}]</span>*/}\n\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName=\"title mr-2 text-primary\"\n\t\t\t\t\t\t\t\t\tonClick={(e) => onToggle(e, item.id)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{item.sGoodsName}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span className=\"mr-4\">가격: {item.iSellPrice}</span>\n\t\t\t\t\t\t\t\t<button onClick={() => onLike(item.id)}>\n\t\t\t\t\t\t\t\t\t❤ {item.likeCount}\n\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonClick={() => onEdit(item.id)}\n\t\t\t\t\t\t\t\t\tclassName=\"button sm ml-4\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t수정\n\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonClick={() => onDelect(item.id)}\n\t\t\t\t\t\t\t\t\tclassName=\"button sm ml-1\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t삭제\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</ul>\n\n\t\t\t\t\t{/* 수정폼 */}\n\n\t\t\t\t\t<div className=\"mt-4\">\n\t\t\t\t\t\t<h4 className=\"f3 mb-2\">수정폼</h4>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tname=\"sGoodsName\"\n\t\t\t\t\t\t\t\tvalue={editInputs.sGoodsName}\n\t\t\t\t\t\t\t\tplaceholder=\"상품명\"\n\t\t\t\t\t\t\t\tonChange={onEditChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tname=\"iSellPrice\"\n\t\t\t\t\t\t\t\tvalue={editInputs.iSellPrice}\n\t\t\t\t\t\t\t\tplaceholder=\"판매가격\"\n\t\t\t\t\t\t\t\tonChange={onEditChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => onEditSucess(editInputs.id)}\n\t\t\t\t\t\t\tclassName=\"button mt-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t수정완료\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n\nexport default Crud;\n"]},"metadata":{},"sourceType":"module"}